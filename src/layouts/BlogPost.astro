---
import type { CollectionEntry } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Header from '../components/Header.astro';

type Props = CollectionEntry<'blog'>['data'];

const { title, description, pubDate, updatedDate, heroImage } = Astro.props;
---

<html lang="en">
	<head>
		<BaseHead title={title} description={description} />
		<style>
			main {
				width: 100%;
                max-width: 100%; /* Override Global CSS constraint */
				margin: 0;
                background: #fff;
                /* Remove padding that restricts full width */
                padding: 0; 
			}
            
            /* Full Bleed Hero */
            .hero-container {
                width: 100%;
                max-width: 100%;
                margin: 0;
                padding: 0;
                overflow: hidden;
            }
			.hero-image {
				width: 100%;
                margin: 0;
			}
			.hero-image img {
				display: block;
                width: 100%;
                height: 60vh; /* Tall cinematic feel */
                object-fit: cover;
                border-radius: 0; /* No radius */
			}
            
            /* Content Container */
			.prose {
				width: 100%;
				max-width: 860px;
				margin: 0 auto;
				padding: 4rem 1.5rem; /* More top padding */
				color: var(--gray-dark);
                font-size: 1.25rem;
                line-height: 1.8;
                font-family: var(--font-body);
			}
			.title {
				margin-bottom: 3rem;
				padding: 1rem 0;
				text-align: center;
				line-height: 1.2s;
			}
			.title h1 {
				margin: 0 0 0.5em 0;
                font-family: var(--font-heading);
                font-size: 3rem; /* Bigger Title */
                color: var(--color-primary);
                line-height: 1.3;
			}
			.date {
				margin-bottom: 1.5rem;
				color: var(--gray);
                font-family: var(--font-body);
                text-transform: uppercase;
                letter-spacing: 0.1em;
                font-size: 0.9rem;
			}
            
            /* Hierarchy corrections */
            .prose h2 {
                font-size: 2rem; /* Smaller than H1 (3rem) */
                margin-top: 3rem;
                margin-bottom: 1.5rem;
                color: var(--color-primary);
                font-family: var(--font-heading);
            }
            .prose h3 {
                font-size: 1.6rem;
                margin-top: 2.5rem;
                margin-bottom: 1rem;
                color: var(--color-primary);
                font-family: var(--font-heading);
            }
            .prose h4 {
                 font-size: 1.3rem;
                 margin-top: 2rem;
            }

            .prose p {
                margin-bottom: 1.8rem;
                text-align: justify; /* Better block alignment */
            }
            
            /* Social Share */
            .social-share {
                margin: 4rem auto;
                padding-top: 2rem;
                border-top: 1px solid #eee;
                text-align: center;
            }
            .social-share h4 {
                font-size: 1rem;
                color: var(--gray);
                text-transform: uppercase;
                letter-spacing: 0.1em;
                margin-bottom: 1.5rem;
            }
            .share-buttons {
                display: flex;
                gap: 1rem;
                justify-content: center;
            }
            .share-btn {
                display: inline-flex;
                align-items: center;
                justify-content: center;
                width: 44px;
                height: 44px; /* Circle */
                padding: 0;
                border: 1px solid #ddd;
                border-radius: 50%; /* Circle */
                color: #555;
                text-decoration: none;
                font-size: 1.2rem;
                transition: all 0.2s;
            }
            .share-btn:hover {
                background: var(--color-red);
                color: white;
                border-color: var(--color-red);
            }
            
            /* Blockquote */
            .prose blockquote {
                border-left: 5px solid var(--color-red);
                padding-left: 1.5rem;
                margin-left: 0;
                font-style: italic;
                color: var(--color-secondary);
                background: var(--color-warm-bg);
                padding: 2rem;
                border-radius: 0 12px 12px 0;
                font-size: 1.3rem;
            }
		</style>
        <!-- FontAwesome for Share Icons -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
	</head>

	<body>
		<Header />
		<main>
			<article>
				<div class="hero-container">
                    <div class="hero-image">
                        {heroImage && <img width={1020} height={510} src={heroImage} alt="" />}
                    </div>
                </div>
				<div class="prose container-narrow">
					<div class="title">
						<div class="date">
							<FormattedDate date={pubDate} />
							{
								updatedDate && (
									<div class="last-updated-on">
										Last updated on <FormattedDate date={updatedDate} />
									</div>
								)
							}
						</div>
						<h1>{title}</h1>
						<hr />
					</div>
					<slot />
                    
                    <!-- Social Share Section -->
                    <div class="social-share">
                        <h4>Share this article</h4>
                        <div class="share-buttons">
                            <a href={`https://www.facebook.com/sharer/sharer.php?u=https://vista.tw/blog/`} target="_blank" class="share-btn" aria-label="Share on Facebook" onclick="this.href='https://www.facebook.com/sharer/sharer.php?u='+window.location.href; return true;">
                                <i class="fa-brands fa-facebook-f"></i>
                            </a>
                            <a href={`https://www.threads.net/intent/post?text=https://vista.tw/blog/`} target="_blank" class="share-btn" aria-label="Share on Threads" onclick="this.href='https://www.threads.net/intent/post?text='+encodeURIComponent(document.title + ' ' + window.location.href); return true;">
                                <i class="fa-brands fa-threads"></i>
                            </a>
                            <a href={`https://twitter.com/intent/tweet?url=https://vista.tw/blog/`} target="_blank" class="share-btn" aria-label="Share on X" onclick="this.href='https://twitter.com/intent/tweet?url='+window.location.href; return true;">
                                <i class="fa-brands fa-x-twitter"></i>
                            </a>
                            <a href={`https://www.linkedin.com/shareArticle?mini=true&url=https://vista.tw/blog/`} target="_blank" class="share-btn" aria-label="Share on LinkedIn" onclick="this.href='https://www.linkedin.com/shareArticle?mini=true&url='+window.location.href; return true;">
                                <i class="fa-brands fa-linkedin-in"></i>
                            </a>
                            <a href={`https://social-plugins.line.me/lineit/share?url=https://vista.tw/blog/`} target="_blank" class="share-btn" aria-label="Share on Line" onclick="this.href='https://social-plugins.line.me/lineit/share?url='+window.location.href; return true;">
                                <i class="fa-brands fa-line"></i>
                            </a>
                        </div>
                    </div>
				</div>
			</article>
		</main>
		<Footer />
        <script>
            // Force external links to open in new tab
            document.addEventListener('DOMContentLoaded', () => {
                const links = document.querySelectorAll('.prose a');
                links.forEach(link => {
                    if (link.hostname !== window.location.hostname) {
                        link.target = '_blank';
                        link.rel = 'noopener noreferrer';
                    }
                });
            });
        </script>
	</body>
</html>
